# AI聊天功能故障排除指南

## 常见问题及解决方案

### 1. 网络超时问题

**问题描述：** 出现 `request:fail timeout` 错误

**解决方案：**
- ✅ 已增加网络超时时间至60秒
- ✅ 已添加自动重试机制（最多3次重试）
- ✅ 已实现指数退避算法，避免频繁重试
- ✅ 已添加网络状态检测

### 2. API调用失败

**可能原因：**
- 网络连接不稳定
- API密钥无效或过期
- 请求频率过高
- 硅基流动服务器临时不可用

**解决方案：**
- 检查网络连接状态
- 验证API密钥有效性
- 控制请求频率（已添加1秒冷却时间）
- 等待服务恢复或联系技术支持

### 3. 小程序域名配置

**重要提醒：** 在正式发布前，需要在微信小程序后台配置以下域名：

```
request合法域名：
https://api.siliconflow.cn
```

**配置步骤：**
1. 登录微信小程序后台
2. 进入「开发」->「开发管理」->「开发设置」
3. 在「服务器域名」中添加上述域名
4. 保存配置并重新发布小程序

### 4. 开发环境调试

**开发者工具设置：**
1. 在微信开发者工具中，勾选「不校验合法域名」
2. 确保网络连接正常
3. 查看控制台日志获取详细错误信息

### 5. 性能优化建议

**已实现的优化：**
- ✅ 减少max_tokens至300，提高响应速度
- ✅ 限制对话历史至最近5条消息
- ✅ 添加发送防抖机制
- ✅ 实现智能错误处理和用户提示
- ✅ 添加网络状态实时监控

**用户体验优化：**
- ✅ 显示详细的错误提示信息
- ✅ 添加发送冷却时间提示
- ✅ 网络状态变化实时通知
- ✅ 智能重试机制，减少用户手动重试

### 6. 错误代码说明

| 错误代码 | 说明 | 解决方案 |
|---------|------|----------|
| 401 | API密钥无效 | 检查API密钥配置 |
| 429 | 请求过于频繁 | 等待冷却时间后重试 |
| 500+ | 服务器错误 | 稍后重试或联系技术支持 |
| timeout | 网络超时 | 检查网络连接，系统会自动重试 |

### 7. 监控和日志

**日志记录：**
- API请求和响应详情
- 网络状态变化
- 错误信息和重试次数
- 用户操作行为

**性能监控：**
- 请求响应时间
- 成功率统计
- 错误类型分析

### 8. 联系支持

如果问题仍然存在，请提供以下信息：
- 错误发生的具体时间
- 控制台错误日志
- 网络环境描述
- 设备和系统信息

**技术支持：** 请联系开发团队或查看硅基流动官方文档

---

## 更新日志

### v1.1.0 (当前版本)
- 🔧 修复网络超时问题
- ⚡ 优化API调用性能
- 🛡️ 增强错误处理机制
- 📱 改善用户体验
- 🔍 添加网络状态监控
- 🔄 实现智能重试机制

### v1.0.0
- 🎉 初始版本发布
- 💬 基础AI聊天功能
- 🔗 硅基流动API集成